<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:Petly.Maui.ViewModels"
             xmlns:controls="clr-namespace:Petly.Maui.Controls"
             x:Class="Petly.Maui.Views.PetsListPage"
             Title="Ð¡Ð¿Ð¸ÑÐ¾Ðº Ñ‚Ð²Ð°Ñ€Ð¸Ð½"
             BackgroundColor="#FFFFFBF7">

    <ContentPage.BindingContext>
        <viewmodels:PetsListViewModel />
    </ContentPage.BindingContext>

    <Grid Background="{DynamicResource Theme_BackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <controls:TopNavBar />

        <!-- BODY -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout>

                <!-- Ð¤Ñ–Ð»ÑŒÑ‚Ñ€Ð¸ + ÐŸÐ¾ÑˆÑƒÐº + Ð”Ð¾Ð´Ð°Ñ‚Ð¸ -->
                <StackLayout Orientation="Horizontal"
                             Spacing="7"
                             Margin="35,15,10,0"
                             HorizontalOptions="Start">

                    <Button Text="Ð£ÑÑ–"
                            Command="{Binding FilterAllCommand}"
                            BackgroundColor="#FFFFD129"
                            BorderWidth="2"
                            HeightRequest="40"
                            CornerRadius="8" />

                    <Button Text="Ð¡Ð¾Ð±Ð°ÐºÐ¸"
                            Command="{Binding FilterDogsCommand}"
                            BackgroundColor="#FFFFC456"
                            BorderWidth="2"
                            HeightRequest="40"
                            CornerRadius="8" />

                    <Button Text="ÐšÐ¾Ñ‚Ð¸"
                            Command="{Binding FilterCatsCommand}"
                            BackgroundColor="#FFFFC456"
                            BorderWidth="2"
                            HeightRequest="40"
                            CornerRadius="8" />

                    <Button Text="ÐŸÑ€Ð¸Ð»Ð°ÑˆÑ‚Ð¾Ð²Ð°Ð½Ñ–"
                            Command="{Binding FilterAdoptedCommand}"
                            BackgroundColor="#FFFFC456"
                            BorderWidth="2"
                            HeightRequest="40"
                            CornerRadius="8" />

                    <!-- ÐŸÐ¾ÑˆÑƒÐº -->
                    <Border Stroke="Black" StrokeThickness="1" Margin="20,0,0,0" WidthRequest="250">
                        <Grid ColumnDefinitions="*,Auto">
                            <Entry Grid.Column="0"
                                   Placeholder="ÐŸÐ¾ÑˆÑƒÐº Ð·Ð° Ñ–Ð¼â€™ÑÐ¼"
                                   Text="{Binding SearchQuery}"
                                   FontSize="15"
                                   PlaceholderColor="#888888"
                                   TextColor="Black"
                                   BackgroundColor="Transparent" />

                            <Button Grid.Column="1"
                                    Text="ðŸ”"
                                    Command="{Binding SearchCommand}"
                                    BackgroundColor="Transparent"
                                    TextColor="Black" />
                        </Grid>
                    </Border>

                    <!-- Ð”ÐžÐ”ÐÐ¢Ð˜ â€” Ð›Ð˜Ð¨Ð• Ð”Ð›Ð¯ ÐÐ”ÐœÐ†ÐÐ -->
                    <Button x:Name="AddPetButton"
                            Text="Ð”Ð¾Ð´Ð°Ñ‚Ð¸"
                            Margin="15,0,0,0"
                            BackgroundColor="#FFFFD129"
                            TextColor="Black"
                            CornerRadius="8"
                            HeightRequest="40"
                            IsVisible="False"
                            Clicked="OnAddPetClicked" />

                </StackLayout>

                <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ñ‚Ð²Ð°Ñ€Ð¸Ð½ -->
                <CollectionView ItemsSource="{Binding PetsCollection}"
                                Margin="20,30,20,20"
                                SelectionMode="None">

                    <CollectionView.ItemsLayout>
                        <GridItemsLayout Orientation="Vertical" Span="2" />
                    </CollectionView.ItemsLayout>

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Stroke="Black" StrokeThickness="1" Margin="5">
                                <VerticalStackLayout>

                                    <Image Aspect="AspectFill"
                                           HeightRequest="200"
                                           Margin="10"
                                           Source="{Binding PhotoUrl}" />

                                    <Label Text="{Binding Type}" FontSize="16" TextColor="#444"
                                           Margin="15,5,0,0"/>

                                    <Label Text="{Binding PetName}" FontSize="18"
                                           TextColor="Black" Margin="15,0,0,0" />

                                    <Label Text="{Binding Age, StringFormat='{}{0} Ñ€Ð¾ÐºÑ–Ð²'}"
                                           FontSize="15" TextColor="#444"
                                           Margin="15,0,0,10" />

                                    <HorizontalStackLayout Padding="25,0,0,15"
                                                           Spacing="10">

                                        <!-- Ð‘Ñ–Ð»ÑŒÑˆÐµ -->
                                        <Button Text="Ð‘Ñ–Ð»ÑŒÑˆÐµ"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:PetsListViewModel}}, Path=MoreInfoCommand}"
                                                CommandParameter="{Binding .}"
                                                BackgroundColor="#A0C4FF"
                                                TextColor="Black"
                                                FontSize="16"
                                                CornerRadius="5"
                                                HeightRequest="35" />

                                        <!-- Ð”Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð° -->
                                        <Button Text="Ð”Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð°"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:PetsListViewModel}}, Path=HelpPetCommand}"
                                                CommandParameter="{Binding .}"
                                                BackgroundColor="#E0E0E0" />

                                        <!-- ÐÐ´Ð¾Ð¿Ñ†Ñ–Ñ -->
                                        <Button Text="ÐÐ´Ð¾Ð¿Ñ†Ñ–Ñ"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:PetsListViewModel}}, Path=AdoptPetCommand}"
                                                CommandParameter="{Binding .}"
                                                BackgroundColor="#E0E0E0" />

                                    </HorizontalStackLayout>
                                </VerticalStackLayout>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>

                </CollectionView>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
