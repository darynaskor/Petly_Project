<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Petly.Maui.Views.AdoptionPage"
             Title="Адопція"
             BackgroundColor="#FFFFFBF7">

    <ScrollView>
        <VerticalStackLayout Padding="25" Spacing="20">

            <!-- Назад -->
            <Button Text="← Назад"
                    BackgroundColor="#FFFFD129"
                    TextColor="Black"
                    BorderWidth="1"
                    CornerRadius="8"
                    WidthRequest="100"
                    Clicked="OnBackClicked"/>

            <Label Text="Адопція"
                   FontSize="28"
                   FontAttributes="Bold"
                   TextColor="Black"/>

            <!-- Статус заявки користувача -->
            <Label x:Name="StatusLabel"
                   FontSize="18"
                   TextColor="DarkGreen"
                   IsVisible="False"/>

            <!-- Форма подання заявки (якщо ще не подав) -->
            <StackLayout x:Name="FormStack" Spacing="15">

                <Label Text="Мої дані" FontSize="20" FontAttributes="Bold" TextColor="Black"/>
                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="15" RowSpacing="10">
                    <Entry x:Name="FirstNameEntry" Placeholder="Ім'я" Grid.Row="0" Grid.Column="0" />
                    <Entry x:Name="LastNameEntry" Placeholder="Прізвище" Grid.Row="0" Grid.Column="1" />
                    <Entry x:Name="EmailEntry" Placeholder="Email" Grid.Row="1" Grid.Column="0" Keyboard="Email" />
                    <Entry x:Name="PhoneEntry" Placeholder="Телефон +380" Grid.Row="1" Grid.Column="1" Keyboard="Telephone" />
                </Grid>

                <Label Text="Про себе" FontSize="20" FontAttributes="Bold" TextColor="Black" />
                <Editor x:Name="DescriptionEntry" Placeholder="Розкажіть про себе..." HeightRequest="100" BackgroundColor="White"/>

                <Label Text="Тваринка" FontSize="20" FontAttributes="Bold" TextColor="Black" Margin="0,10,0,0"/>
                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="15" RowSpacing="10">
                    <Entry x:Name="PetNameEntry" Placeholder="Ім’я тварини" Grid.Row="0" Grid.Column="0" />
                    <Entry x:Name="PetTypeEntry" Placeholder="Вид (кіт, собака...)" Grid.Row="0" Grid.Column="1" />
                    <Entry x:Name="PetAgeEntry" Placeholder="Вік (наприклад: 2 роки)" Grid.Row="1" Grid.Column="0" />
                    <Picker x:Name="PetGenderPicker" Grid.Row="1" Grid.Column="1"
                            Title="Стать"
                            BackgroundColor="White"
                            TextColor="Black">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>Самець ♂</x:String>
                                <x:String>Самка ♀</x:String>
                                <x:String>Невідомо ⚪</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>
                </Grid>

                <Button Text="Надіслати заявку"
                        BackgroundColor="#FFFFD129"
                        TextColor="Black"
                        FontAttributes="Bold"
                        CornerRadius="10"
                        HeightRequest="45"
                        Clicked="OnSubmitClicked"/>
            </StackLayout>
            
            <!-- НИЖЧЕ існуючої форми -->
            <VerticalStackLayout Spacing="8" Margin="0,24,0,0">
                <Label Text="Мої заявки на адопцію"
           FontSize="20"
           FontAttributes="Bold"
           TextColor="Black"/>

                <Label x:Name="EmptyRequestsLabel"
           Text="Поки що немає заявок."
           TextColor="#666666"
           IsVisible="False"/>

                <CollectionView x:Name="MyRequestsList"
                    IsVisible="False"
                    SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Stroke="#DDDDDD" StrokeThickness="1" Margin="0,4">
                                <Grid ColumnDefinitions="80,*" Padding="8">
                                    <Image Grid.Column="0"
                               HeightRequest="64"
                               WidthRequest="64"
                               Aspect="AspectFill"
                               Source="{Binding PetPhotoUrl}" />

                                    <VerticalStackLayout Grid.Column="1" Spacing="2">
                                        <Label Text="{Binding PetName}"
                                   FontAttributes="Bold"
                                   TextColor="Black"/>
                                        <Label Text="{Binding Status}"
                                   FontSize="13"
                                   TextColor="#444"/>
                                        <Label Text="{Binding CreatedAt, StringFormat='від {0:dd.MM.yyyy HH:mm}'}"
                                   FontSize="12"
                                   TextColor="#888"/>
                                    </VerticalStackLayout>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
            
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
